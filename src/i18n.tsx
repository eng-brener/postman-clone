import { createContext, useCallback, useContext, useEffect, useMemo, useState, type ReactNode } from "react";

export type Language = "en" | "pt-BR" | "es";

export const LANGUAGE_STORAGE_KEY = "postman-clone.language";

const translations = {
  en: {
    "app.name": "Postman Clone",
    "app.noTabs": "No tabs open",
    "app.newRequest": "New Request",
    "app.emptyTitle": "Postman Clone",
    "app.emptySubtitle": "Open a request tab to get started.",
    "app.emptyCta": "+ New Request",
    "app.requestTabNew": "New Request",
    "app.history": "History",
    "app.historyEmpty": "No history yet.",
    "app.historyCollapse": "Collapse history",
    "app.historyExpand": "Expand history",
    "app.historyRun": "Run request",
    "app.historyPin": "Pin",
    "app.historyUnpin": "Unpin",
    "app.searchCollections": "Search collections...",
    "app.collection": "Collection",
    "app.collectionEmpty": "No collections found.",
    "app.settings": "Settings",
    "app.workspace": "Workspace",
    "app.workspacesTitle": "Workspaces",
    "app.workspaceActiveLabel": "Active workspace",
    "app.workspacesManage": "Manage workspaces",
    "app.workspaceNew": "+ New",
    "app.workspaceDuplicate": "Duplicate",
    "app.workspaceDelete": "Delete",
    "app.workspaceDeleteConfirm": "Delete workspace \"{{name}}\"? This action cannot be undone.",
    "app.workspaceDescriptionLabel": "Description",
    "app.workspaceSubtitle": "Collections and environments are scoped to a workspace.",
    "app.workspaceBadge": "{{name}}",
    "app.workspaceEmptyState": "Select a workspace to edit its settings.",
    "app.noEnvironment": "No Environment",
    "app.environment": "Environment",
    "app.envActiveLabel": "Active environment",
    "app.envModalTitle": "Environments",
    "app.envNew": "+ New",
    "app.envVarsCount": "{{count}} vars",
    "app.envHint": "Use {{variable}} in URLs, headers, or bodies.",
    "app.envNameLabel": "Name",
    "app.envDelete": "Delete",
    "app.envVariables": "Variables",
    "app.envVariablesSubtitle": "Set key/value pairs for this environment.",
    "app.envEmptyState": "Select an environment to edit variables.",
    "app.close": "Close",
    "app.contextCollection": "Collection",
    "app.contextFolder": "Folder",
    "app.contextRequest": "Request",
    "app.addRequest": "Add Request",
    "app.addFolder": "Add Folder",
    "app.run": "Run",
    "app.share": "Share",
    "app.move": "Move",
    "app.rename": "Rename",
    "app.duplicate": "Duplicate",
    "app.sort": "Sort",
    "app.delete": "Delete",
    "app.renameTitle": "Rename {{type}}",
    "app.newTitle": "New {{type}}",
    "app.deleteTitle": "Delete {{type}}",
    "app.moveTitle": "Move {{type}}",
    "app.nameLabel": "Name",
    "app.typeLabel": "Type",
    "app.methodLabel": "Method",
    "app.urlLabel": "URL",
    "app.destinationLabel": "Destination",
    "app.cancel": "Cancel",
    "app.save": "Save",
    "app.create": "Create",
    "app.deleteConfirm": "Delete \"{{name}}\"? This action cannot be undone.",
    "app.moveRoot": "Root",
    "app.requestBuilderSoon": "{{type}} request builder coming soon.",
    "app.requestPlaceholder": "Placeholder for {{type}} request inputs.",
    "app.responsePlaceholder": "Send a {{type}} request to see the response here.",
    "app.requestTabLabel": "Request",
    "app.responseTabLabel": "Response",
    "app.settingsTitle": "Settings",
    "app.settingsGeneral": "General",
    "app.settingsAbout": "About",
    "app.settingsGeneralTitle": "General",
    "app.settingsGeneralDesc": "Configure app defaults and behavior.",
    "app.settingsTheme": "Theme",
    "app.settingsThemeDesc": "Choose your preferred appearance.",
    "app.settingsThemeDark": "Dark (Current)",
    "app.settingsThemeLight": "Light",
    "app.settingsThemeDracula": "Dracula",
    "app.settingsLanguage": "Language",
    "app.settingsLanguageDesc": "Choose your preferred language.",
    "app.settingsAboutTitle": "About",
    "app.settingsAboutText": "{{name}} v{{version}} - built with Tauri + React.",
    "app.methodMenu": "HTTP method",
    "app.urlPlaceholder": "Enter URL",
    "app.send": "Send",
    "app.resolvedLabel": "Resolved:",
    "app.dragResize": "Drag to resize",
    "app.urlInvalid": "Invalid URL",
    "tabs.params": "Params",
    "tabs.authorization": "Authorization",
    "tabs.headers": "Headers",
    "tabs.cookies": "Cookies",
    "tabs.body": "Body",
    "tabs.settings": "Settings",
    "request.addParam": "+ Add Param",
    "request.addHeader": "+ Add Header",
    "request.authType": "Auth Type",
    "request.authNone": "No Auth",
    "request.authApiKey": "API Key",
    "request.authBearer": "Bearer Token",
    "request.authBasic": "Basic Auth",
    "request.authEmpty": "This request does not use any authorization.",
    "request.key": "Key",
    "request.value": "Value",
    "request.addTo": "Add to",
    "request.header": "Header",
    "request.queryParams": "Query Params",
    "request.token": "Token",
    "request.bearerToken": "Bearer Token",
    "request.username": "Username",
    "request.password": "Password",
    "request.cookiesEmptyUrl": "Enter a valid URL to manage cookies.",
    "request.cookiesDomain": "Domain",
    "request.addCookie": "+ Add Cookie",
    "request.filterDomain": "Filter domain",
    "request.filterPath": "Filter path",
    "request.cookiesWarning": "SameSite=None requires Secure. Some cookies may be rejected by browsers.",
    "request.cookiesEmptyDomain": "No cookies for this domain yet.",
    "request.cookiesEmptyFilter": "No cookies match the filters.",
    "request.cookiesOn": "On",
    "request.cookiesName": "Name",
    "request.cookiesValue": "Value",
    "request.cookiesDomainHeader": "Domain",
    "request.cookiesPath": "Path",
    "request.cookiesHostOnly": "Host Only",
    "request.cookiesExpires": "Expires",
    "request.cookiesSecure": "Secure",
    "request.cookiesHttpOnly": "HttpOnly",
    "request.cookiesSameSite": "SameSite",
    "request.cookiesDelete": "Delete",
    "request.bodyNone": "none",
    "request.bodyFormData": "form-data",
    "request.bodyUrlEncoded": "x-www-form-urlencoded",
    "request.bodyRaw": "raw",
    "request.bodyBinary": "binary",
    "request.bodyEmpty": "This request has no body",
    "request.bodyBinaryHint": "Binary body type not fully implemented (File upload)",
    "request.settingsHttpVersion": "HTTP Version",
    "request.settingsHttpVersionDesc": "Protocol used for the request.",
    "request.settingsSsl": "SSL Certificate Verification",
    "request.settingsSslDesc": "Validate the server certificate chain.",
    "request.settingsRedirects": "Automatically Follow Redirects",
    "request.settingsRedirectsDesc": "Handle 3xx responses without manual steps.",
    "response.preview": "Preview",
    "response.headers": "Header",
    "response.cookies": "Cookies",
    "response.raw": "Raw",
    "response.headersCount": "Header ({{count}})",
    "response.cookiesCount": "Cookies ({{count}})",
    "response.redirects": "Redirects",
    "response.error": "Error",
    "response.empty": "Send a request to see the response here",
    "response.search": "Search in response",
    "response.wrap": "Wrap {{state}}",
    "response.key": "Key",
    "response.value": "Value",
    "response.cookiesEmpty": "No cookies returned.",
    "response.expandName": "Expand name",
    "response.collapseName": "Collapse name",
    "response.expandValue": "Expand value",
    "response.collapseValue": "Collapse value",
    "response.yes": "Yes",
    "response.no": "No",
    "editor.key": "Key",
    "editor.value": "Value",
    "editor.bulkEdit": "Bulk edit",
    "editor.bulkHint": "One per line. Use \"key: value\". Prefix with \"#\" to disable.",
    "editor.bulkPlaceholder": "Authorization: Bearer {{token}}",
    "editor.bulkCancel": "Cancel",
    "editor.bulkApply": "Apply",
    "editor.removeItem": "Remove item",
    "editor.keyPlaceholder": "Key",
    "editor.valuePlaceholder": "Value",
    "editor.duplicateWarning": "Duplicate keys detected.",
    "state.on": "On",
    "state.off": "Off",
  },
  "pt-BR": {
    "app.name": "Postman Clone",
    "app.noTabs": "Nenhuma aba aberta",
    "app.newRequest": "Nova Requisicao",
    "app.emptyTitle": "Postman Clone",
    "app.emptySubtitle": "Abra uma aba de requisicao para comecar.",
    "app.emptyCta": "+ Nova Requisicao",
    "app.requestTabNew": "Nova Requisicao",
    "app.history": "Historico",
    "app.historyEmpty": "Sem historico ainda.",
    "app.historyCollapse": "Recolher historico",
    "app.historyExpand": "Expandir historico",
    "app.historyRun": "Executar requisicao",
    "app.historyPin": "Fixar",
    "app.historyUnpin": "Desafixar",
    "app.searchCollections": "Buscar colecoes...",
    "app.collection": "Colecao",
    "app.collectionEmpty": "Nenhuma colecao encontrada.",
    "app.settings": "Configuracoes",
    "app.workspace": "Workspace",
    "app.workspacesTitle": "Workspaces",
    "app.workspaceActiveLabel": "Workspace ativo",
    "app.workspacesManage": "Gerenciar workspaces",
    "app.workspaceNew": "+ Novo",
    "app.workspaceDuplicate": "Duplicar",
    "app.workspaceDelete": "Excluir",
    "app.workspaceDeleteConfirm": "Excluir workspace \"{{name}}\"? Esta acao nao pode ser desfeita.",
    "app.workspaceDescriptionLabel": "Descricao",
    "app.workspaceSubtitle": "Colecoes e ambientes ficam separados por workspace.",
    "app.workspaceBadge": "{{name}}",
    "app.workspaceEmptyState": "Selecione um workspace para editar as configuracoes.",
    "app.noEnvironment": "Sem Ambiente",
    "app.environment": "Ambiente",
    "app.envActiveLabel": "Ambiente ativo",
    "app.envModalTitle": "Ambientes",
    "app.envNew": "+ Novo",
    "app.envVarsCount": "{{count}} vars",
    "app.envHint": "Use {{variable}} em URLs, headers ou bodies.",
    "app.envNameLabel": "Nome",
    "app.envDelete": "Excluir",
    "app.envVariables": "Variaveis",
    "app.envVariablesSubtitle": "Defina pares chave/valor para este ambiente.",
    "app.envEmptyState": "Selecione um ambiente para editar variaveis.",
    "app.close": "Fechar",
    "app.contextCollection": "Colecao",
    "app.contextFolder": "Pasta",
    "app.contextRequest": "Requisicao",
    "app.addRequest": "Adicionar Requisicao",
    "app.addFolder": "Adicionar Pasta",
    "app.run": "Executar",
    "app.share": "Compartilhar",
    "app.move": "Mover",
    "app.rename": "Renomear",
    "app.duplicate": "Duplicar",
    "app.sort": "Ordenar",
    "app.delete": "Excluir",
    "app.renameTitle": "Renomear {{type}}",
    "app.newTitle": "Novo {{type}}",
    "app.deleteTitle": "Excluir {{type}}",
    "app.moveTitle": "Mover {{type}}",
    "app.nameLabel": "Nome",
    "app.typeLabel": "Tipo",
    "app.methodLabel": "Metodo",
    "app.urlLabel": "URL",
    "app.destinationLabel": "Destino",
    "app.cancel": "Cancelar",
    "app.save": "Salvar",
    "app.create": "Criar",
    "app.deleteConfirm": "Excluir \"{{name}}\"? Esta acao nao pode ser desfeita.",
    "app.moveRoot": "Raiz",
    "app.requestBuilderSoon": "Construtor de requisicoes {{type}} em breve.",
    "app.requestPlaceholder": "Placeholder para entradas de requisicao {{type}}.",
    "app.responsePlaceholder": "Envie uma requisicao {{type}} para ver a resposta aqui.",
    "app.requestTabLabel": "Requisicao",
    "app.responseTabLabel": "Resposta",
    "app.settingsTitle": "Configuracoes",
    "app.settingsGeneral": "Geral",
    "app.settingsAbout": "Sobre",
    "app.settingsGeneralTitle": "Geral",
    "app.settingsGeneralDesc": "Configure padroes e comportamento do app.",
    "app.settingsTheme": "Tema",
    "app.settingsThemeDesc": "Escolha sua aparencia preferida.",
    "app.settingsThemeDark": "Escuro (Atual)",
    "app.settingsThemeLight": "Claro",
    "app.settingsThemeDracula": "Dracula",
    "app.settingsLanguage": "Idioma",
    "app.settingsLanguageDesc": "Escolha seu idioma preferido.",
    "app.settingsAboutTitle": "Sobre",
    "app.settingsAboutText": "{{name}} v{{version}} - feito com Tauri + React.",
    "app.methodMenu": "Metodo HTTP",
    "app.urlPlaceholder": "Digite a URL",
    "app.send": "Enviar",
    "app.resolvedLabel": "Resolvida:",
    "app.dragResize": "Arraste para redimensionar",
    "app.urlInvalid": "URL invalida",
    "tabs.params": "Params",
    "tabs.authorization": "Autorizacao",
    "tabs.headers": "Headers",
    "tabs.cookies": "Cookies",
    "tabs.body": "Body",
    "tabs.settings": "Configuracoes",
    "request.addParam": "+ Adicionar Param",
    "request.addHeader": "+ Adicionar Header",
    "request.authType": "Tipo de Auth",
    "request.authNone": "Sem Auth",
    "request.authApiKey": "Chave de API",
    "request.authBearer": "Token Bearer",
    "request.authBasic": "Auth Basica",
    "request.authEmpty": "Esta requisicao nao usa autorizacao.",
    "request.key": "Chave",
    "request.value": "Valor",
    "request.addTo": "Adicionar em",
    "request.header": "Header",
    "request.queryParams": "Query Params",
    "request.token": "Token",
    "request.bearerToken": "Token Bearer",
    "request.username": "Usuario",
    "request.password": "Senha",
    "request.cookiesEmptyUrl": "Informe uma URL valida para gerenciar cookies.",
    "request.cookiesDomain": "Dominio",
    "request.addCookie": "+ Adicionar Cookie",
    "request.filterDomain": "Filtrar dominio",
    "request.filterPath": "Filtrar path",
    "request.cookiesWarning": "SameSite=None requer Secure. Alguns cookies podem ser rejeitados.",
    "request.cookiesEmptyDomain": "Sem cookies para este dominio.",
    "request.cookiesEmptyFilter": "Nenhum cookie corresponde aos filtros.",
    "request.cookiesOn": "On",
    "request.cookiesName": "Nome",
    "request.cookiesValue": "Valor",
    "request.cookiesDomainHeader": "Dominio",
    "request.cookiesPath": "Path",
    "request.cookiesHostOnly": "Host Only",
    "request.cookiesExpires": "Expira",
    "request.cookiesSecure": "Secure",
    "request.cookiesHttpOnly": "HttpOnly",
    "request.cookiesSameSite": "SameSite",
    "request.cookiesDelete": "Excluir",
    "request.bodyNone": "nenhum",
    "request.bodyFormData": "form-data",
    "request.bodyUrlEncoded": "x-www-form-urlencoded",
    "request.bodyRaw": "raw",
    "request.bodyBinary": "binary",
    "request.bodyEmpty": "Esta requisicao nao possui body",
    "request.bodyBinaryHint": "Body binario nao implementado (Upload de arquivo)",
    "request.settingsHttpVersion": "Versao HTTP",
    "request.settingsHttpVersionDesc": "Protocolo usado na requisicao.",
    "request.settingsSsl": "Verificacao de certificado SSL",
    "request.settingsSslDesc": "Valida a cadeia de certificados do servidor.",
    "request.settingsRedirects": "Seguir redirecionamentos automaticamente",
    "request.settingsRedirectsDesc": "Lida com respostas 3xx sem passos manuais.",
    "response.preview": "Preview",
    "response.headers": "Header",
    "response.cookies": "Cookies",
    "response.raw": "Raw",
    "response.headersCount": "Header ({{count}})",
    "response.cookiesCount": "Cookies ({{count}})",
    "response.redirects": "Redirecionamentos",
    "response.error": "Erro",
    "response.empty": "Envie uma requisicao para ver a resposta aqui",
    "response.search": "Buscar na resposta",
    "response.wrap": "Quebra {{state}}",
    "response.key": "Chave",
    "response.value": "Valor",
    "response.cookiesEmpty": "Nenhum cookie retornado.",
    "response.expandName": "Expandir nome",
    "response.collapseName": "Recolher nome",
    "response.expandValue": "Expandir valor",
    "response.collapseValue": "Recolher valor",
    "response.yes": "Sim",
    "response.no": "Nao",
    "editor.key": "Chave",
    "editor.value": "Valor",
    "editor.bulkEdit": "Edicao em massa",
    "editor.bulkHint": "Uma linha por item. Use \"chave: valor\". Prefixe com \"#\" para desativar.",
    "editor.bulkPlaceholder": "Authorization: Bearer {{token}}",
    "editor.bulkCancel": "Cancelar",
    "editor.bulkApply": "Aplicar",
    "editor.removeItem": "Remover item",
    "editor.keyPlaceholder": "Chave",
    "editor.valuePlaceholder": "Valor",
    "editor.duplicateWarning": "Chaves duplicadas detectadas.",
    "state.on": "On",
    "state.off": "Off",
  },
  es: {
    "app.name": "Postman Clone",
    "app.noTabs": "No hay pestanas abiertas",
    "app.newRequest": "Nueva Solicitud",
    "app.emptyTitle": "Postman Clone",
    "app.emptySubtitle": "Abre una pestana de solicitud para empezar.",
    "app.emptyCta": "+ Nueva Solicitud",
    "app.requestTabNew": "Nueva Solicitud",
    "app.history": "Historial",
    "app.historyEmpty": "Sin historial todavia.",
    "app.historyCollapse": "Contraer historial",
    "app.historyExpand": "Expandir historial",
    "app.historyRun": "Ejecutar solicitud",
    "app.historyPin": "Fijar",
    "app.historyUnpin": "Desfijar",
    "app.searchCollections": "Buscar colecciones...",
    "app.collection": "Coleccion",
    "app.collectionEmpty": "No se encontraron colecciones.",
    "app.settings": "Configuracion",
    "app.workspace": "Workspace",
    "app.workspacesTitle": "Workspaces",
    "app.workspaceActiveLabel": "Workspace activo",
    "app.workspacesManage": "Administrar workspaces",
    "app.workspaceNew": "+ Nuevo",
    "app.workspaceDuplicate": "Duplicar",
    "app.workspaceDelete": "Eliminar",
    "app.workspaceDeleteConfirm": "Eliminar workspace \"{{name}}\"? Esta accion no se puede deshacer.",
    "app.workspaceDescriptionLabel": "Descripcion",
    "app.workspaceSubtitle": "Las colecciones y entornos quedan por workspace.",
    "app.workspaceBadge": "{{name}}",
    "app.workspaceEmptyState": "Selecciona un workspace para editar su configuracion.",
    "app.noEnvironment": "Sin Entorno",
    "app.environment": "Entorno",
    "app.envActiveLabel": "Entorno activo",
    "app.envModalTitle": "Entornos",
    "app.envNew": "+ Nuevo",
    "app.envVarsCount": "{{count}} vars",
    "app.envHint": "Usa {{variable}} en URLs, headers o bodies.",
    "app.envNameLabel": "Nombre",
    "app.envDelete": "Eliminar",
    "app.envVariables": "Variables",
    "app.envVariablesSubtitle": "Define pares clave/valor para este entorno.",
    "app.envEmptyState": "Selecciona un entorno para editar variables.",
    "app.close": "Cerrar",
    "app.contextCollection": "Coleccion",
    "app.contextFolder": "Carpeta",
    "app.contextRequest": "Solicitud",
    "app.addRequest": "Agregar Solicitud",
    "app.addFolder": "Agregar Carpeta",
    "app.run": "Ejecutar",
    "app.share": "Compartir",
    "app.move": "Mover",
    "app.rename": "Renombrar",
    "app.duplicate": "Duplicar",
    "app.sort": "Ordenar",
    "app.delete": "Eliminar",
    "app.renameTitle": "Renombrar {{type}}",
    "app.newTitle": "Nuevo {{type}}",
    "app.deleteTitle": "Eliminar {{type}}",
    "app.moveTitle": "Mover {{type}}",
    "app.nameLabel": "Nombre",
    "app.typeLabel": "Tipo",
    "app.methodLabel": "Metodo",
    "app.urlLabel": "URL",
    "app.destinationLabel": "Destino",
    "app.cancel": "Cancelar",
    "app.save": "Guardar",
    "app.create": "Crear",
    "app.deleteConfirm": "Eliminar \"{{name}}\"? Esta accion no se puede deshacer.",
    "app.moveRoot": "Raiz",
    "app.requestBuilderSoon": "Constructor de solicitudes {{type}} pronto.",
    "app.requestPlaceholder": "Placeholder para entradas de solicitud {{type}}.",
    "app.responsePlaceholder": "Envia una solicitud {{type}} para ver la respuesta aqui.",
    "app.requestTabLabel": "Solicitud",
    "app.responseTabLabel": "Respuesta",
    "app.settingsTitle": "Configuracion",
    "app.settingsGeneral": "General",
    "app.settingsAbout": "Acerca de",
    "app.settingsGeneralTitle": "General",
    "app.settingsGeneralDesc": "Configura valores y comportamiento de la app.",
    "app.settingsTheme": "Tema",
    "app.settingsThemeDesc": "Elige tu apariencia preferida.",
    "app.settingsThemeDark": "Oscuro (Actual)",
    "app.settingsThemeLight": "Claro",
    "app.settingsThemeDracula": "Dracula",
    "app.settingsLanguage": "Idioma",
    "app.settingsLanguageDesc": "Elige tu idioma preferido.",
    "app.settingsAboutTitle": "Acerca de",
    "app.settingsAboutText": "{{name}} v{{version}} - hecho con Tauri + React.",
    "app.methodMenu": "Metodo HTTP",
    "app.urlPlaceholder": "Ingresa la URL",
    "app.send": "Enviar",
    "app.resolvedLabel": "Resuelta:",
    "app.dragResize": "Arrastra para redimensionar",
    "app.urlInvalid": "URL invalida",
    "tabs.params": "Params",
    "tabs.authorization": "Autorizacion",
    "tabs.headers": "Headers",
    "tabs.cookies": "Cookies",
    "tabs.body": "Body",
    "tabs.settings": "Configuracion",
    "request.addParam": "+ Agregar Param",
    "request.addHeader": "+ Agregar Header",
    "request.authType": "Tipo de Auth",
    "request.authNone": "Sin Auth",
    "request.authApiKey": "Clave API",
    "request.authBearer": "Token Bearer",
    "request.authBasic": "Auth Basica",
    "request.authEmpty": "Esta solicitud no usa autorizacion.",
    "request.key": "Clave",
    "request.value": "Valor",
    "request.addTo": "Agregar a",
    "request.header": "Header",
    "request.queryParams": "Query Params",
    "request.token": "Token",
    "request.bearerToken": "Token Bearer",
    "request.username": "Usuario",
    "request.password": "Contrasena",
    "request.cookiesEmptyUrl": "Ingresa una URL valida para administrar cookies.",
    "request.cookiesDomain": "Dominio",
    "request.addCookie": "+ Agregar Cookie",
    "request.filterDomain": "Filtrar dominio",
    "request.filterPath": "Filtrar path",
    "request.cookiesWarning": "SameSite=None requiere Secure. Algunos cookies pueden ser rechazados.",
    "request.cookiesEmptyDomain": "No hay cookies para este dominio.",
    "request.cookiesEmptyFilter": "Ninguna cookie coincide con los filtros.",
    "request.cookiesOn": "On",
    "request.cookiesName": "Nombre",
    "request.cookiesValue": "Valor",
    "request.cookiesDomainHeader": "Dominio",
    "request.cookiesPath": "Path",
    "request.cookiesHostOnly": "Host Only",
    "request.cookiesExpires": "Expira",
    "request.cookiesSecure": "Secure",
    "request.cookiesHttpOnly": "HttpOnly",
    "request.cookiesSameSite": "SameSite",
    "request.cookiesDelete": "Eliminar",
    "request.bodyNone": "ninguno",
    "request.bodyFormData": "form-data",
    "request.bodyUrlEncoded": "x-www-form-urlencoded",
    "request.bodyRaw": "raw",
    "request.bodyBinary": "binary",
    "request.bodyEmpty": "Esta solicitud no tiene body",
    "request.bodyBinaryHint": "Body binario no implementado (Carga de archivo)",
    "request.settingsHttpVersion": "Version HTTP",
    "request.settingsHttpVersionDesc": "Protocolo usado para la solicitud.",
    "request.settingsSsl": "Verificacion de certificado SSL",
    "request.settingsSslDesc": "Valida la cadena de certificados del servidor.",
    "request.settingsRedirects": "Seguir redirecciones automaticamente",
    "request.settingsRedirectsDesc": "Gestiona respuestas 3xx sin pasos manuales.",
    "response.preview": "Preview",
    "response.headers": "Header",
    "response.cookies": "Cookies",
    "response.raw": "Raw",
    "response.headersCount": "Header ({{count}})",
    "response.cookiesCount": "Cookies ({{count}})",
    "response.redirects": "Redirecciones",
    "response.error": "Error",
    "response.empty": "Envia una solicitud para ver la respuesta aqui",
    "response.search": "Buscar en la respuesta",
    "response.wrap": "Ajuste {{state}}",
    "response.key": "Clave",
    "response.value": "Valor",
    "response.cookiesEmpty": "No se devolvieron cookies.",
    "response.expandName": "Expandir nombre",
    "response.collapseName": "Contraer nombre",
    "response.expandValue": "Expandir valor",
    "response.collapseValue": "Contraer valor",
    "response.yes": "Si",
    "response.no": "No",
    "editor.key": "Clave",
    "editor.value": "Valor",
    "editor.bulkEdit": "Edicion masiva",
    "editor.bulkHint": "Una linea por item. Usa \"clave: valor\". Prefija con \"#\" para desactivar.",
    "editor.bulkPlaceholder": "Authorization: Bearer {{token}}",
    "editor.bulkCancel": "Cancelar",
    "editor.bulkApply": "Aplicar",
    "editor.removeItem": "Eliminar item",
    "editor.keyPlaceholder": "Clave",
    "editor.valuePlaceholder": "Valor",
    "editor.duplicateWarning": "Claves duplicadas detectadas.",
    "state.on": "On",
    "state.off": "Off",
  },
} as const;

export type TranslationKey = keyof typeof translations.en;

type I18nContextValue = {
  language: Language;
  setLanguage: (language: Language) => void;
  t: (key: TranslationKey, vars?: Record<string, string | number>) => string;
};

const I18nContext = createContext<I18nContextValue | null>(null);

const detectLanguage = (): Language => {
  if (typeof navigator === "undefined") {
    return "en";
  }
  const code = navigator.language.toLowerCase();
  if (code.startsWith("pt")) {
    return "pt-BR";
  }
  if (code.startsWith("es")) {
    return "es";
  }
  return "en";
};

const interpolate = (value: string, vars?: Record<string, string | number>) => {
  if (!vars) {
    return value;
  }
  return value.replace(/{{\s*([a-zA-Z0-9_.-]+)\s*}}/g, (match, key) => {
    if (Object.prototype.hasOwnProperty.call(vars, key)) {
      return String(vars[key]);
    }
    return match;
  });
};

export const I18nProvider = ({ children }: { children: ReactNode }) => {
  const [language, setLanguage] = useState<Language>(() => {
    if (typeof window === "undefined" || !("localStorage" in window)) {
      return detectLanguage();
    }
    const stored = window.localStorage.getItem(LANGUAGE_STORAGE_KEY);
    if (stored === "en" || stored === "pt-BR" || stored === "es") {
      return stored;
    }
    return detectLanguage();
  });

  useEffect(() => {
    if (typeof window === "undefined" || !("localStorage" in window)) {
      return;
    }
    window.localStorage.setItem(LANGUAGE_STORAGE_KEY, language);
  }, [language]);

  const t = useCallback(
    (key: TranslationKey, vars?: Record<string, string | number>) => {
      const langPack = translations[language] ?? translations.en;
      const base = langPack[key] ?? translations.en[key] ?? key;
      return interpolate(base, vars);
    },
    [language]
  );

  const value = useMemo(() => ({ language, setLanguage, t }), [language, t]);

  return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>;
};

export const useI18n = () => {
  const context = useContext(I18nContext);
  if (!context) {
    throw new Error("useI18n must be used within I18nProvider");
  }
  return context;
};

export const LANGUAGE_OPTIONS: { value: Language; label: string }[] = [
  { value: "pt-BR", label: "Portuguese (Brasil)" },
  { value: "en", label: "English" },
  { value: "es", label: "Espanol" },
];
